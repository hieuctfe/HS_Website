@{
    ViewBag.Title = "Chỉnh Sửa Banner Trang Chủ";

    string action = ViewContext.RouteData.Values["action"].ToString(),
        controller = ViewContext.RouteData.Values["controller"].ToString();

    string bannerPath = ViewBag.BannerPath;
    int i = 0;
}

@section CustomStyles
{
    <link href="@Url.AppVendors("sweetalert/sweetalert.css")" rel="stylesheet" />
    <link href="@Url.AppVendors("cropper/cropper.min.css")" rel="stylesheet" />

    <style>
        .img-container {
            min-height: 300px;
        }

        .no-image-background {
            background: white;
            display: flex;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 99;
            line-height: 300px;
        }

        .activeCropper {
            width: 100%;
            cursor: pointer;
        }

        #image-popup-gallery img {
            cursor: pointer
        }

        .btn-delete {
            top: calc(0px - 5px);
            right: calc(0px + 5px);
            padding: 0;
            height: 20px;
            width: 20px;
            line-height: 20px;
            outline: 0;
            border-radius: 50%;
            cursor: pointer;
        }

        form label {
            color: black;
        }
    </style>
}

@section CustomScripts
{
    <script src="@Url.AppCustoms("js/common.js")"></script>
    <script src="@Url.AppVendors("sweetalert/sweetalert.min.js")"></script>
    <script src="@Url.AppVendors("cropper/cropper.min.js")"></script>
    <script src="@Url.AppVendors("cropper/cropper-init-multi-image-modified.js")"></script>
    <script type="text/javascript">
        $(function () {
            var cropper = new MyLib.CropperFactory({ $CropperModal: '#modalCropper' });
            var $mainForm = $('#accordion');

            $mainForm.find('.form-material').each(function (index, e) {
                cropper.Create(`#slider`, 1, NaN, '', true, index++);
            });
        });

        $("button[name='submitForm']").on('click', function () {
            $(this).parent().find('form').submit();
        });
    </script>
}

<div class="card">
    <div class="card-body">
        <h4 class="card-title" style="display: -webkit-inline-box; margin-bottom: 25px">Cập Nhật Banner</h4>
        <button type="button" name="submitForm" class="btn btn-success waves-effect waves-light mr-2 float-right">Save Changes</button>
        @using (Html.BeginForm(action, controller, FormMethod.Post, new { id = "mainFormContainer" }))
        {
            @Html.AntiForgeryToken()
            <div id="accordion">
                <div class="card">
                    <div class="card-header" id="heading@(i)">
                        <h5 class="mb-0">
                            <button type="button" class="btn btn-link collapsed active" data-toggle="collapse" data-target="#collapse@(i)" aria-expanded="true" aria-controls="collapseOne">
                                Banner
                            </button>
                        </h5>
                    </div>
                    <div id="collapse@(i)" class="collapse show" aria-labelledby="heading@(i)" data-parent="#accordion">
                        <div class="card-body">
                            <div class="form-material row col-12 float-left">
                                <div class="col-12 m-t-20">
                                    <label>Ảnh nền</label>
                                    @{ Html.RenderPartial("ViewComponents/_ImageCropper",
                                                  new _ImageCropper
                                                  {
                                                      CropActiveId = $"slider",
                                                      ImageContainer = $"sliderContainer",
                                                      ImageUploaded = string.IsNullOrEmpty(bannerPath) ? string.Empty : bannerPath,
                                                      ButtonText = "Select Images (1920 x 280)"
                                                  });
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
@{ Html.RenderPartial("ViewComponents/_ImageCropperModal"); }